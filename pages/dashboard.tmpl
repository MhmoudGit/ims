{{define "dashboard"}}
<html lang='en'>
{{template "head" .}}
<head>
     <link rel="stylesheet" href="/dashboard.css">
</head>
<body>
    {{template "header" .}}
    <h3 class="styled-heading">  Hello, {{.User.Name}}</h3>
    <div class="dashboard">
        <div class="table-container">
             <h3>Projects</h3>
             {{ if eq .User.Type "coordinator" }}

              <button class="green-button" onclick="window.location.href='/create-project?t=c';">
              {{message "create_project"}}
              </button>

             {{ end }}
             <table style="width: 100%;">
                   <thead>
                       <tr>
                           <th>ID</th>
                           <th>Name</th>
                           <th>Type</th>
                           <th>State</th>
                           <th>Project Nature</th>
                           <th>Owner</th>
                           <th>Location</th>
                           <th>Dollar Value</th>
                           <th>No. of top level scope packages</th>
                           <th></th>
                           <th></th>
                       </tr>
                   </thead>
                   <tbody>
                       {{range .Projects}}
                       <tr onmouseover="this.style.backgroundColor='rgb(196, 196, 196)';" onmouseout="this.style.backgroundColor='white';">
                           <td>{{.ID}}</td>
                           <td> <a href="/project?name={{.Name}}" style="text-decoration: none; color: blue;"> {{.Name}}</td>
                           <td>{{.Type}}</td>
                           <td>{{.State}}</td>
                           <td>{{.ProjectNature}}</td>
                           <td>{{.Owner}}</td>
                           <td>{{.Location}}</td>
                           <td>{{.DollarValue}}</td>
                           <td>{{.Tlsp}}</td>
                           <td style="background-color: rgb(255, 83, 83); color: white; padding: 0;"><button onclick="deleteItem('{{.ID}}')" style="width: 100%; height: 100%; padding: 5px; margin: 0; border: none; background: none; cursor: pointer;">Delete</button></td>
                           <td style="background-color: rgb(67, 67, 67); color: white; padding: 0;"><a href="/project-edit?id={{.ID}}"  style=" color: white; width: 100%; height: 100%; padding: 5px; margin: 0; border: none; background: none; cursor: pointer; text-decoration: none;">Edit</button></td>
                       </tr>
                       {{end}}
                   </tbody>
               </table>
          </div>
    </div>
    {{template "footer" .}}
</body>

<script>
    function deleteItem(id) {
        if (confirm("Are you sure you want to delete this item?")) {
            fetch('/project?id=' + id, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to delete item');
                }
                // Handle successful deletion
                window.location.reload(); // Reload the window
            })
            .catch(error => {
                alert('Error deleting item:', error)
            });
        }
    }
</script>

</html>
{{end}}
